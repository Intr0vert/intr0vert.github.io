(self["webpackChunkunicorn_banners"]=self["webpackChunkunicorn_banners"]||[]).push([[334],{4019:function(t){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},3403:function(t,e,i){"use strict";var s,a,n,r=i(4019),o=i(9781),h=i(7854),l=i(614),c=i(111),d=i(2597),u=i(648),m=i(6330),g=i(8880),p=i(1320),y=i(3070).f,f=i(7976),v=i(9518),b=i(7674),x=i(5112),S=i(9711),w=h.Int8Array,T=w&&w.prototype,A=h.Uint8ClampedArray,k=A&&A.prototype,R=w&&v(w),L=T&&v(T),z=Object.prototype,E=h.TypeError,_=x("toStringTag"),B=S("TYPED_ARRAY_TAG"),C=S("TYPED_ARRAY_CONSTRUCTOR"),M=r&&!!b&&"Opera"!==u(h.opera),W=!1,D={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},F={BigInt64Array:8,BigUint64Array:8},H=function(t){if(!c(t))return!1;var e=u(t);return"DataView"===e||d(D,e)||d(F,e)},N=function(t){if(!c(t))return!1;var e=u(t);return d(D,e)||d(F,e)},P=function(t){if(N(t))return t;throw E("Target is not a typed array")},I=function(t){if(l(t)&&(!b||f(R,t)))return t;throw E(m(t)+" is not a typed array constructor")},O=function(t,e,i,s){if(o){if(i)for(var a in D){var n=h[a];if(n&&d(n.prototype,t))try{delete n.prototype[t]}catch(r){try{n.prototype[t]=e}catch(l){}}}L[t]&&!i||p(L,t,i?e:M&&T[t]||e,s)}},U=function(t,e,i){var s,a;if(o){if(b){if(i)for(s in D)if(a=h[s],a&&d(a,t))try{delete a[t]}catch(n){}if(R[t]&&!i)return;try{return p(R,t,i?e:M&&R[t]||e)}catch(n){}}for(s in D)a=h[s],!a||a[t]&&!i||p(a,t,e)}};for(s in D)a=h[s],n=a&&a.prototype,n?g(n,C,a):M=!1;for(s in F)a=h[s],n=a&&a.prototype,n&&g(n,C,a);if((!M||!l(R)||R===Function.prototype)&&(R=function(){throw E("Incorrect invocation")},M))for(s in D)h[s]&&b(h[s],R);if((!M||!L||L===z)&&(L=R.prototype,M))for(s in D)h[s]&&b(h[s].prototype,L);if(M&&v(k)!==L&&b(k,L),o&&!d(L,_))for(s in W=!0,y(L,_,{get:function(){return c(this)?this[B]:void 0}}),D)h[s]&&g(h[s],B,s);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:M,TYPED_ARRAY_CONSTRUCTOR:C,TYPED_ARRAY_TAG:W&&B,aTypedArray:P,aTypedArrayConstructor:I,exportTypedArrayMethod:O,exportTypedArrayStaticMethod:U,isView:H,isTypedArray:N,TypedArray:R,TypedArrayPrototype:L}},8544:function(t,e,i){var s=i(1068);t.exports=!s((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},9518:function(t,e,i){var s=i(7854),a=i(2597),n=i(614),r=i(7908),o=i(6200),h=i(8544),l=o("IE_PROTO"),c=s.Object,d=c.prototype;t.exports=h?c.getPrototypeOf:function(t){var e=r(t);if(a(e,l))return e[l];var i=e.constructor;return n(i)&&e instanceof i?i.prototype:e instanceof c?d:null}},4590:function(t,e,i){var s=i(7854),a=i(3002),n=s.RangeError;t.exports=function(t,e){var i=a(t);if(i%e)throw n("Wrong offset");return i}},3002:function(t,e,i){var s=i(7854),a=i(9303),n=s.RangeError;t.exports=function(t){var e=a(t);if(e<0)throw n("The argument can't be less than 0");return e}},8675:function(t,e,i){"use strict";var s=i(3403),a=i(6244),n=i(9303),r=s.aTypedArray,o=s.exportTypedArrayMethod;o("at",(function(t){var e=r(this),i=a(e),s=n(t),o=s>=0?s:i+s;return o<0||o>=i?void 0:e[o]}))},3462:function(t,e,i){"use strict";var s=i(7854),a=i(6916),n=i(3403),r=i(6244),o=i(4590),h=i(7908),l=i(1068),c=s.RangeError,d=s.Int8Array,u=d&&d.prototype,m=u&&u.set,g=n.aTypedArray,p=n.exportTypedArrayMethod,y=!l((function(){var t=new Uint8ClampedArray(2);return a(m,t,{length:1,0:3},1),3!==t[1]})),f=y&&n.NATIVE_ARRAY_BUFFER_VIEWS&&l((function(){var t=new d(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));p("set",(function(t){g(this);var e=o(arguments.length>1?arguments[1]:void 0,1),i=h(t);if(y)return a(m,this,i,e);var s=this.length,n=r(i),l=0;if(n+e>s)throw c("Wrong length");while(l<n)this[e+l]=i[l++]}),!y||f)},62:function(t,e,i){"use strict";i.d(e,{i:function(){return c}});var s=i(4301),a=i(3396),n=i(2037),r=i(5553);const o=t=>"[object Object]"===Object.prototype.toString.call(t);i(8675),i(3462);let h=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>(e&=63,t+=e<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_",t)),"");const l=(0,r.x)(),c=(0,s.Q_)("banners",{state:()=>({banners:{data:[],status:"",error:""},banner:{data:{conversion:"",userGroup:null,category:null,canvases:[{title:"Insta Post (Ads)",width:1080,height:1080,layers:{},schemes:{}},{title:"Stories (Ads)",width:1080,height:1920,layers:{},schemes:{}},{title:"Fb / Youtube / Email",width:1280,height:720,layers:{},schemes:{}}],layers:[],schemes:[],files:[]},status:"",error:""},listFontFamily:[{label:"Gilroy",value:'"Gilroy", sans-serif'},{label:"Proxima Nova",value:'"Proxima Nova", sans-serif'},{label:"Montserrat",value:'"Montserrat", sans-serif'},{label:"Bebas Neue",value:'"Bebas Neue", sans-serif'},{label:"Microsoft Sans Serif",value:'"Microsoft Sans Serif", sans-serif'},{label:"Nanum Pen",value:'"Nanum Pen", cursive'},{label:"Bodoni",value:'"Bodoni", serif'}],listFontWeight:[{label:"Thin",value:100},{label:"Extra Light",value:200},{label:"Light",value:300},{label:"Normal",value:400},{label:"Medium",value:500},{label:"Semi Bold",value:600},{label:"Bold",value:700},{label:"Extra Bold",value:800},{label:"Black",value:900}],listImageShapes:[{label:"Прямоугольная",value:"rectangle"},{label:"Круглая",value:"circle"}],listUserGroups:[{label:"Для всех",value:"all"},{label:"Для premium",value:"premium"}],copyrightTypes:["light","transparent","dark"],currentSchemeId:"",currentCanvasId:0,selectedColorScheme:null}),getters:{listCategories(){return l.categories.data.map((({id:t,name:e})=>({label:e,value:t})))},canvases(){return this.banner.data.canvases},canvas(){return this.canvases[this.currentCanvasId]},schemes(){return this.banner.data.schemes},layers(){return this.banner.data.layers},files(){return this.banner.data.files},downloadsCount(){return this.banner.data.used},conversion(){return this.banner.data.conversion},activeLayer(){return this.layers.find((t=>t.isActive))||{}}},actions:{async getBanners(){this.banners.status="loading";try{const{data:t}=await n.Z.banners.get();return this.banners.data=t.banners.map((t=>(t.data={conversion:t.conversion,userGroup:t.is_premium?this.listUserGroups[1]:this.listUserGroups[0],category:this.listCategories.find((e=>e.value===t.category_id)),schemes:t.data?.schemes||[],canvases:t.data?.canvases||[],layers:t.data?.layers||[],files:t.files||[]},t))),this.banners.status="success",this.banners.error=null,Promise.resolve()}catch(t){return this.banners.status="error",this.banners.error=t,Promise.reject(t)}},async getBanner(t){this.banner.status="loading";try{const{data:e}=await n.Z.banners.get(t);return e.data?.canvases?.forEach((t=>{o(t.layers)||(t.layers={})})),this.banner.data={used:e.used,conversion:e.conversion,userGroup:e.is_premium?this.listUserGroups[1]:this.listUserGroups[0],category:this.listCategories.find((t=>t.value===e.category_id)),schemes:e.data?.schemes||[],canvases:this.prepareCanvases(e.data?.canvases)||[],layers:e.data?.layers||[],files:e.files||[]},this.layers.forEach((t=>{"text"===t.type&&this.addTextLayerGetterSetter(t)})),this.currentSchemeId=this.banner.data.schemes[0]?.id,this.banner.status="success",this.banner.error=null,Promise.resolve()}catch(e){return this.banner.status="error",this.banner.error=e,Promise.reject(e)}},async createBanner(t){try{const{data:e}=await n.Z.banners.create(t);return Promise.resolve(e)}catch(e){return Promise.reject(e)}},async updateBanner(t){try{const{data:e}=await n.Z.banners.update(t);return Promise.resolve(e)}catch(e){return Promise.reject(e)}},async deleteBanner(t){try{const{data:e}=await n.Z.banners["delete"](t);return Promise.resolve(e)}catch(e){return Promise.reject(e)}},async restoreBanner(t){try{const{data:e}=await n.Z.banners.restore(t);return Promise.resolve(e)}catch(e){return Promise.reject(e)}},prepareCanvases(t){return t.map((t=>({...t,checked:!1})))},addTextLayerGetterSetter(t){Object.defineProperty(t,"text",{get(){return this._text},set(t){this._text=t?.slice(0,this.textLimit||void 0)}}),Object.defineProperty(t,"textLimit",{get(){return this._textLimit},set(t){this._textLimit=t,this.text=this._text}})},setCanvasId(t){this.currentCanvasId=t},getLayersByTitles(t){return this.banner.data.layers.reduce(((e,i)=>(t.includes(i.title)&&(e[i.title]=i),e)),{})},getWidth({id:t},e,i){return e.layers[t].width??i.canvases[0].layers[t].width??100},getHeight({id:t},e,i){return e.layers[t].height??i.canvases[0].layers[t].height??100},getTopOffset({id:t},e,i){return e.layers[t].top??i.canvases[0].layers[t].top??10},getLeftOffset({id:t},e,i){return e.layers[t].left??i.canvases[0].layers[t].left??i.canvases[0].width/2-50},getImage(t,e,i){const s=i||e.schemes[0].id;return this.getFile(t.schemes[s].image)||{}},getImageShape({id:t},e,i){return e.layers[t].shape??i.canvases[0].layers[t].shape??this.listImageShapes[0]},getBorderRadius({id:t},e,i){return e.layers[t].borderRadius??i.canvases[0].layers[t].borderRadius??0},getFontSize({id:t},e,i){return e.layers[t].fontSize??i.canvases[0].layers[t].fontSize??16},getFontColor({id:t},e,i,s){const a=s||i.schemes[0].id;return e.layers[t].schemes[a].fontColor??i.canvases[0].layers[t].schemes[a].fontColor??"#000000"},getFontFamily({id:t},e,i){return e.layers[t].fontFamily??i.canvases[0].layers[t].fontFamily??this.listFontFamily[0]},getFontWeight({id:t},e,i){return e.layers[t].fontWeight??i.canvases[0].layers[t].fontWeight??this.listFontWeight[3]},getTextAlign({id:t},e,i){return e.layers[t].textAlign??i.canvases[0].layers[t].textAlign??"left"},getTextVerticalAlign({id:t},e,i){return e.layers[t].textVerticalAlign??i.canvases[0].layers[t].textVerticalAlign??"flex-start"},getLineHeight({id:t},e,i){return e.layers[t].lineHeight??i.canvases[0].layers[t].lineHeight??110},getLetterSpacing({id:t},e,i){return e.layers[t].letterSpacing??i.canvases[0].layers[t].letterSpacing??0},getRotation({id:t},e,i){return e.layers[t].rotate??i.canvases[0].layers[t].rotate??0},getCopyrightType(t,e,i){const s=i||e.schemes[0].id;return t.schemes[s].copyright||e.canvases[0].schemes[s].copyright||this.copyrightTypes[0]},getBackgroundStyle(t,e,i){const s=i||e.schemes[0].id,a=this.getFile(e,t.schemes[s]?.background);return a.url?`url(${a.url})`:null},getBackgroundWithTextStyle(t,e,i){const s=i||e.schemes[0].id,a=this.getFile(e,t.schemes[s]?.backgroundWithText);return a.url?`url(${a.url})`:null},setTitle(t,e){t.title=e},setLeftOffset({id:t},e){this.canvas.layers[t].left=Number(e.target.value)},setTopOffset({id:t},e){this.canvas.layers[t].top=Number(e.target.value)},setWidth({id:t},e){this.canvas.layers[t].width=Number(e.target.value)},setHeight({id:t},e){this.canvas.layers[t].height=Number(e.target.value)},setFontFamily({id:t},e){this.canvas.layers[t].fontFamily=e},setFontWeight({id:t},e){this.canvas.layers[t].fontWeight=e},setFontSize({id:t},e){this.canvas.layers[t].fontSize=e.target.value},setFontColor({id:t},e){const i=this.canvas.layers[t];i.schemes[this.currentSchemeId].fontColor=e.hex||e.target.value},setLineHeight({id:t},e){this.canvas.layers[t].lineHeight=e.target.value},setLetterSpacing({id:t},e){this.canvas.layers[t].letterSpacing=e.target.value},setTextAlign({id:t},e){this.canvas.layers[t].textAlign=e.target.value},setTextVerticalAlign({id:t},e){this.canvas.layers[t].textVerticalAlign=e.target.value},setImageShape({id:t},e){const i=this.canvas.layers[t];if("circle"===e.value){const{width:t,height:e}=i;t>e?i.width=e:i.height=t}(0,a.Y3)((()=>{i.shape=e}))},setBorderRadius({id:t},e){this.canvas.layers[t].borderRadius=e.target.value},setRotation({id:t},e){this.canvas.layers[t].rotate=e.target.value},setUserGroup(t){this.banner.userGroup=this.listUserGroups[t]},addColorScheme(t,e){const i=this.schemes[0]?.id,s=h();this.schemes.push({id:s,...t}),i?this.canvases.forEach((t=>{const e=JSON.parse(JSON.stringify(t.schemes[i]));t.schemes[s]={...e},this.layers.forEach((e=>{const a=JSON.parse(JSON.stringify(e.schemes[i]));e.schemes[s]={...a};const n=t.layers[e.id],r=JSON.parse(JSON.stringify(n.schemes[i]));n.schemes[s]={...r}}))})):this.canvases.forEach((t=>{t.schemes[s]={background:"",backgroundWithText:""}})),this.switchColorScheme(s),e&&(0,a.Y3)((()=>{e.scrollTo(e.scrollWidth,0)}))},updateColorScheme(t){const e=this.schemes.find((e=>e.id===t.id));e.color=t.color,e.usedColors=t.usedColors},switchColorScheme(t){this.currentSchemeId=t},selectColorScheme(t){this.selectedColorScheme=this.schemes.find((e=>e.id===t))},getColorScheme(t){return this.schemes.find((e=>e.id===t))||{}},addFile(t){this.files.push(t)},deleteFile(t){const e=[],i=this.files.find((e=>e.id===t));if(!i)return;this.canvases.forEach((t=>{Object.entries(t.schemes).forEach((([,t])=>{t.background&&e.push(t.background),t.backgroundWithText&&e.push(t.backgroundWithText)}))})),this.layers.forEach((t=>{Object.entries(t.schemes).forEach((([,t])=>{t.image&&e.push(t.image)}))}));const s=e.filter((e=>e===t));0===s.length&&this.files.splice(this.files.indexOf(i),1)},getFile(t,e){return t.files.find((t=>t.id===e))||{}},addLayer(t){const e=h(),i={type:t,id:e,schemes:{}},s={width:null,height:null,top:null,left:null,rotate:null,schemes:{}};switch(t){case"image":this.schemes.forEach((t=>{i.schemes[t.id]={image:""},s.schemes[t.id]={}})),i.title="Изображение",s.shape=null,s.lockAspectRatio=!1;break;case"text":this.schemes.forEach((t=>{i.schemes[t.id]={},s.schemes[t.id]={fontColor:null}})),i._text="Ваш текст большой",i._textLimit="",i.title="",s.fontFamily=null,s.fontWeight=null,s.fontSize=null,s.lineHeight=null,s.letterSpacing=null,s.textAlign=null,s.textVerticalAlign=null,this.addTextLayerGetterSetter(i);break;default:break}this.layers.unshift(i),this.canvases.forEach((t=>{t.layers[e]=JSON.parse(JSON.stringify(s))})),this.activateLayer(i)},deleteLayer(t){const e=this.layers.findIndex((e=>e.id===t.id));this.layers.splice(e,1),this.canvases.forEach((e=>{delete e.layers[t.id]})),this.activateLayer(this.layers[0])},positionLayer(t,e){const i=this.activeLayer;this.canvas.layers[i.id].top=e,this.canvas.layers[i.id].left=t},resizeLayer(t,e,i,s){const a=this.activeLayer;this.canvas.layers[a.id].width=i,this.canvas.layers[a.id].height=s,this.canvas.layers[a.id].top=e,this.canvas.layers[a.id].left=t},activateLayer(t){this.layers.forEach((e=>{e.isActive=e.id===t.id}))},deactivateLayer(t){t.isActive=!1},shiftLayer(t,e,i){const s=this.canvas.layers[t.id],a=i?10:1,n=this.getLeftOffset(t),r=this.getTopOffset(t);switch(e){case"up":s.top=r-a;break;case"right":s.left=n+a;break;case"down":s.top=r+a;break;case"left":s.left=n-a;break;default:break}},updateImage(t,e){const i=t.schemes[this.currentSchemeId],s=i.image;i.image=e?.id,this.addFile(e),this.deleteFile(s)},updateBackground(t){const e=this.canvas.schemes[this.currentSchemeId],i=e.background;e.background=t?.id,this.addFile(t),this.deleteFile(i)},updateBackgroundWithText(t){const e=this.canvas.schemes[this.currentSchemeId],i=e.backgroundWithText;e.backgroundWithText=t?.id,this.addFile(t),this.deleteFile(i)},resetState(){this.currentSchemeId="",this.currentCanvasId=0,this.banner.status="",this.banner.error="";const t=this.banner.data;t.conversion="",t.userGroup=null,t.category=null,t.layers=[],t.schemes=[],t.files=[],t.canvases.forEach((t=>{t.layers={},t.schemes={}}))}}})},8334:function(t,e,i){"use strict";i.d(e,{Z:function(){return H}});var s=i(3396),a=i(7139),n=i(9242);const r={key:0,class:"canvas_image_placeholder"},o=["src"],h={class:"canvas_text_wrapper"},l=["onUpdate:modelValue","disabled"],c={ref:"preload",class:"canvas_preload"};function d(t,e,i,d,u,m){const g=(0,s.up)("AppIcon"),p=(0,s.up)("VueDraggableResizable"),y=(0,s.up)("BannerCopyright");return(0,s.wg)(),(0,s.iD)("div",{class:"canvas_wrapper",style:(0,a.j5)({"--zoom":i.zoom,"--canvas-width":`${i.canvas.width}px`,"--canvas-height":`${i.canvas.height}px`})},[(0,s._)("div",{class:(0,a.C_)(["canvas",{"canvas--rounded":i.rounded}]),ref:"canvas"},[(0,s._)("div",{class:"canvas_bg",style:(0,a.j5)({"--background":d.bannersStore.getBackgroundStyle(i.canvas,i.banner,i.scheme),"--background-with-text":d.bannersStore.getBackgroundWithTextStyle(i.canvas,i.banner,i.scheme)})},null,4),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.layers,(c=>((0,s.wg)(),(0,s.j4)(p,{key:c.id,draggable:i.editable,resizable:i.editable,w:d.bannersStore.getWidth(c,i.canvas,i.banner),h:d.bannersStore.getHeight(c,i.canvas,i.banner),y:d.bannersStore.getTopOffset(c,i.canvas,i.banner),x:d.bannersStore.getLeftOffset(c,i.canvas,i.banner),minh:0,minw:0,scale:i.zoom,lockAspectRatio:"circle"===d.bannersStore.getImageShape(c,i.canvas,i.banner).value,active:c.isActive,"onUpdate:active":t=>c.isActive=t,onResizing:d.bannersStore.resizeLayer,onDragging:d.bannersStore.positionLayer,onActivated:t=>d.bannersStore.activateLayer(c),onDeactivated:t=>d.bannersStore.deactivateLayer(c),class:(0,a.C_)(["canvas_layer",{"is-disabled":!i.editable}])},{default:(0,s.w5)((()=>["image"===c.type?((0,s.wg)(),(0,s.iD)("div",{key:0,class:(0,a.C_)(["canvas_image",{"is-circle":"circle"===d.bannersStore.getImageShape(c,i.canvas,i.banner).value}]),style:(0,a.j5)({"--border-radius":`${d.bannersStore.getBorderRadius(c,i.canvas,i.banner)}px`,"--rotate":`${d.bannersStore.getRotation(c,i.canvas,i.banner)}deg`})},[d.bannersStore.getImage(c,i.banner,i.scheme).url?((0,s.wg)(),(0,s.iD)("img",{key:1,class:"canvas_image_picture",src:d.bannersStore.getImage(c,i.banner,i.scheme).url},null,8,o)):((0,s.wg)(),(0,s.iD)("div",r,[(0,s.Wm)(g,{icon:"gallery"})]))],6)):(0,s.kq)("",!0),"text"===c.type?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"canvas_text",style:(0,a.j5)({"--font-size":`${d.bannersStore.getFontSize(c,i.canvas,i.banner)}px`,"--font-color":d.bannersStore.getFontColor(c,i.canvas,i.banner,i.scheme),"--font-family":d.bannersStore.getFontFamily(c,i.canvas,i.banner).value,"--font-weight":d.bannersStore.getFontWeight(c,i.canvas,i.banner).value,"--text-align":d.bannersStore.getTextAlign(c,i.canvas,i.banner),"--text-vertical-align":d.bannersStore.getTextVerticalAlign(c,i.canvas,i.banner),"--line-height":d.bannersStore.getLineHeight(c,i.canvas,i.banner)/100+"em","--letter-spacing":d.bannersStore.getLetterSpacing(c,i.canvas,i.banner)/100+"em","--rotate":`${d.bannersStore.getRotation(c,i.canvas,i.banner)}deg`}),onDblclick:e[2]||(e[2]=(0,n.iM)(((...t)=>m.enterTextEditMode&&m.enterTextEditMode(...t)),["prevent","stop"]))},[(0,s._)("div",h,[(0,s._)("div",null,(0,a.zw)(c.text)+" ",1),i.editable?(0,s.wy)(((0,s.wg)(),(0,s.iD)("textarea",{key:0,rows:"1","onUpdate:modelValue":t=>c.text=t,disabled:!t.isTextEditMode,onBlur:e[0]||(e[0]=e=>t.isTextEditMode=!1),onMousedown:e[1]||(e[1]=(0,n.iM)((()=>{}),["stop"]))},null,40,l)),[[n.nr,c.text]]):(0,s.kq)("",!0)])],36)):(0,s.kq)("",!0)])),_:2},1032,["draggable","resizable","w","h","y","x","scale","lockAspectRatio","active","onUpdate:active","onResizing","onDragging","onActivated","onDeactivated","class"])))),128)),(0,s.Wm)(y,{variant:d.bannersStore.getCopyrightType(i.canvas,i.banner,i.scheme),class:"canvas_copyright"},null,8,["variant"])],2),(0,s._)("div",c,null,512)],4)}var u=i(205);const m=["onMousedown","onTouchstart"];function g(t,e,i,r,o,h){return(0,s.wg)(),(0,s.iD)("div",{style:(0,a.j5)(h.style),class:(0,a.C_)([{[i.classNameActive]:t.enabled,[i.classNameDragging]:t.dragging,[i.classNameResizing]:t.resizing,[i.classNameDraggable]:i.draggable,[i.classNameResizable]:i.resizable},i.className]),onMousedown:e[0]||(e[0]=(0,n.iM)(((...t)=>h.elementMouseDown&&h.elementMouseDown(...t)),["stop"])),onTouchstart:e[1]||(e[1]=(0,n.iM)(((...t)=>h.elementTouchDown&&h.elementTouchDown(...t)),["stop"]))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(h.actualHandles,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:(0,a.C_)([i.classNameHandle,i.classNameHandle+"-"+e]),style:(0,a.j5)({display:t.enabled?"block":"none"}),onMousedown:(0,n.iM)((t=>h.handleDown(e,t)),["stop","prevent"]),onTouchstart:(0,n.iM)((t=>h.handleTouchDown(e,t)),["stop","prevent"])},[(0,s.WI)(t.$slots,e)],46,m)))),128)),(0,s.WI)(t.$slots,"default")],38)}function p(t){return"function"===typeof t||"[object Function]"===Object.prototype.toString.call(t)}function y(t,e,i,s=1){const[a,n]="number"===typeof s?[s,s]:s,r=Math.round(e/a/t[0])*t[0],o=Math.round(i/n/t[1])*t[1];return[r,o]}function f(t,e,i){return t-e-i}function v(t,e,i){return t-e-i}function b(t,e,i){return null!==e&&t<e?e:null!==i&&i<t?i:t}function x(t,e,i){let s=t;const a=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find((t=>p(s[t])));if(!p(s[a]))return!1;do{if(s[a](e))return!0;if(s===i)return!1;s=s.parentNode}while(s);return!1}function S(t){const e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function w(t,e,i){t&&(t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener?t.addEventListener(e,i):t["on"+e]=i)}function T(t,e,i){t&&(t.detachEvent?t.detachEvent("on"+e,i):t.removeEventListener?t.removeEventListener(e,i):t["on"+e]=null)}const A={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},k={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},R={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let L=A.mouse;var z={replace:!0,name:"vue-draggable-resizable",props:{className:{type:String,default:"vdr"},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},lockAspectRatio:{type:Boolean,default:!1},w:{type:[Number,String],default:200,validator:t=>"number"===typeof t?t>0:"auto"===t},h:{type:[Number,String],default:200,validator:t=>"number"===typeof t?t>0:"auto"===t},minWidth:{type:Number,default:0,validator:t=>t>=0},minHeight:{type:Number,default:0,validator:t=>t>=0},maxWidth:{type:Number,default:null,validator:t=>t>=0},maxHeight:{type:Number,default:null,validator:t=>t>=0},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:[String,Number],default:"auto",validator:t=>"string"===typeof t?"auto"===t:t>=0},handles:{type:Array,default:()=>["tl","tm","tr","mr","br","bm","bl","ml"],validator:t=>{const e=new Set(["tl","tm","tr","mr","br","bm","bl","ml"]);return new Set(t.filter((t=>e.has(t)))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:t=>["x","y","both"].includes(t)},grid:{type:Array,default:()=>[1,1]},parent:{type:Boolean,default:!1},scale:{type:[Number,Array],default:1,validator:t=>"number"===typeof t?t>0:2===t.length&&t[0]>0&&t[1]>0},onDragStart:{type:Function,default:()=>!0},onDrag:{type:Function,default:()=>!0},onResizeStart:{type:Function,default:()=>!0},onResize:{type:Function,default:()=>!0}},data:function(){return{left:this.x,top:this.y,right:null,bottom:null,width:null,height:null,widthTouched:!1,heightTouched:!1,aspectFactor:null,parentWidth:null,parentHeight:null,minW:this.minWidth,minH:this.minHeight,maxW:this.maxWidth,maxH:this.maxHeight,handle:null,enabled:this.active,resizing:!1,dragging:!1,dragEnable:!1,resizeEnable:!1,zIndex:this.z}},created:function(){this.maxWidth&&this.minWidth>this.maxWidth&&console.warn("[Vdr warn]: Invalid prop: minWidth cannot be greater than maxWidth"),this.maxWidth&&this.minHeight>this.maxHeight&&console.warn("[Vdr warn]: Invalid prop: minHeight cannot be greater than maxHeight"),this.resetBoundsAndMouseState()},mounted:function(){this.enableNativeDrag||(this.$el.ondragstart=()=>!1);const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e;const[i,s]=S(this.$el);this.aspectFactor=("auto"!==this.w?this.w:i)/("auto"!==this.h?this.h:s),this.width="auto"!==this.w?this.w:i,this.height="auto"!==this.h?this.h:s,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.active&&this.$emit("activated"),w(document.documentElement,"mousedown",this.deselect),w(document.documentElement,"touchend touchcancel",this.deselect),w(window,"resize",this.checkParentSize)},beforeUnmount:function(){T(document.documentElement,"mousedown",this.deselect),T(document.documentElement,"touchstart",this.handleUp),T(document.documentElement,"mousemove",this.move),T(document.documentElement,"touchmove",this.move),T(document.documentElement,"mouseup",this.handleUp),T(document.documentElement,"touchend touchcancel",this.deselect),T(window,"resize",this.checkParentSize)},methods:{resetBoundsAndMouseState(){this.mouseClickPosition={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},this.bounds={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},checkParentSize(){if(this.parent){const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top}},getParentSize(){if(this.parent){const t=window.getComputedStyle(this.$el.parentNode,null);return[parseInt(t.getPropertyValue("width"),10),parseInt(t.getPropertyValue("height"),10)]}return[null,null]},elementTouchDown(t){L=A.touch,this.elementDown(t)},elementMouseDown(t){L=A.mouse,this.elementDown(t)},elementDown(t){if(t instanceof MouseEvent&&1!==t.which)return;const e=t.target||t.srcElement;if(this.$el.contains(e)){if(!1===this.onDragStart(t))return;if(this.dragHandle&&!x(e,this.dragHandle,this.$el)||this.dragCancel&&x(e,this.dragCancel,this.$el))return void(this.dragging=!1);this.enabled||(this.enabled=!0,this.$emit("activated"),this.$emit("update:active",!0)),this.draggable&&(this.dragEnable=!0),this.mouseClickPosition.mouseX=t.touches?t.touches[0].pageX:t.pageX,this.mouseClickPosition.mouseY=t.touches?t.touches[0].pageY:t.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.parent&&(this.bounds=this.calcDragLimits()),w(document.documentElement,L.move,this.move),w(document.documentElement,L.stop,this.handleUp)}},calcDragLimits(){return{minLeft:this.left%this.grid[0],maxLeft:Math.floor((this.parentWidth-this.width-this.left)/this.grid[0])*this.grid[0]+this.left,minRight:this.right%this.grid[0],maxRight:Math.floor((this.parentWidth-this.width-this.right)/this.grid[0])*this.grid[0]+this.right,minTop:this.top%this.grid[1],maxTop:Math.floor((this.parentHeight-this.height-this.top)/this.grid[1])*this.grid[1]+this.top,minBottom:this.bottom%this.grid[1],maxBottom:Math.floor((this.parentHeight-this.height-this.bottom)/this.grid[1])*this.grid[1]+this.bottom}},deselect(t){const e=t.target||t.srcElement,i=new RegExp(this.className+"-([trmbl]{2})","");this.$el.contains(e)||i.test(e.className)||(this.enabled&&!this.preventDeactivation&&(this.enabled=!1,this.$emit("deactivated"),this.$emit("update:active",!1)),T(document.documentElement,L.move,this.handleResize)),this.resetBoundsAndMouseState()},handleTouchDown(t,e){L=A.touch,this.handleDown(t,e)},handleDown(t,e){e instanceof MouseEvent&&1!==e.which||!1!==this.onResizeStart(t,e)&&(e.stopPropagation&&e.stopPropagation(),this.lockAspectRatio&&!t.includes("m")?this.handle="m"+t.substring(1):this.handle=t,this.resizeEnable=!0,this.mouseClickPosition.mouseX=e.touches?e.touches[0].pageX:e.pageX,this.mouseClickPosition.mouseY=e.touches?e.touches[0].pageY:e.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.bounds=this.calcResizeLimits(),w(document.documentElement,L.move,this.handleResize),w(document.documentElement,L.stop,this.handleUp))},calcResizeLimits(){let t=this.minW,e=this.minH,i=this.maxW,s=this.maxH;const a=this.aspectFactor,[n,r]=this.grid,o=this.width,h=this.height,l=this.left,c=this.top,d=this.right,u=this.bottom;this.lockAspectRatio&&(t/e>a?e=t/a:t=a*e,i&&s?(i=Math.min(i,a*s),s=Math.min(s,i/a)):i?s=i/a:s&&(i=a*s)),i-=i%n,s-=s%r;const m={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return this.parent?(m.minLeft=l%n,m.maxLeft=l+Math.floor((o-t)/n)*n,m.minTop=c%r,m.maxTop=c+Math.floor((h-e)/r)*r,m.minRight=d%n,m.maxRight=d+Math.floor((o-t)/n)*n,m.minBottom=u%r,m.maxBottom=u+Math.floor((h-e)/r)*r,i&&(m.minLeft=Math.max(m.minLeft,this.parentWidth-d-i),m.minRight=Math.max(m.minRight,this.parentWidth-l-i)),s&&(m.minTop=Math.max(m.minTop,this.parentHeight-u-s),m.minBottom=Math.max(m.minBottom,this.parentHeight-c-s)),this.lockAspectRatio&&(m.minLeft=Math.max(m.minLeft,l-c*a),m.minTop=Math.max(m.minTop,c-l/a),m.minRight=Math.max(m.minRight,d-u*a),m.minBottom=Math.max(m.minBottom,u-d/a))):(m.minLeft=null,m.maxLeft=l+Math.floor((o-t)/n)*n,m.minTop=null,m.maxTop=c+Math.floor((h-e)/r)*r,m.minRight=null,m.maxRight=d+Math.floor((o-t)/n)*n,m.minBottom=null,m.maxBottom=u+Math.floor((h-e)/r)*r,i&&(m.minLeft=-(d+i),m.minRight=-(l+i)),s&&(m.minTop=-(u+s),m.minBottom=-(c+s)),this.lockAspectRatio&&i&&s&&(m.minLeft=Math.min(m.minLeft,-(d+i)),m.minTop=Math.min(m.minTop,-(s+u)),m.minRight=Math.min(m.minRight,-l-i),m.minBottom=Math.min(m.minBottom,-c-s))),m},move(t){this.resizing?this.handleResize(t):this.dragEnable&&this.handleDrag(t)},handleDrag(t){t.preventDefault(),t.stopPropagation();const e=this.axis,i=this.grid,s=this.bounds,a=this.mouseClickPosition,n=e&&"y"!==e?a.mouseX-(t.touches?t.touches[0].pageX:t.pageX):0,r=e&&"x"!==e?a.mouseY-(t.touches?t.touches[0].pageY:t.pageY):0,[o,h]=y(i,n,r,this.scale),l=b(a.left-o,s.minLeft,s.maxLeft),c=b(a.top-h,s.minTop,s.maxTop);if(!1===this.onDrag(l,c))return;const d=b(a.right+o,s.minRight,s.maxRight),u=b(a.bottom+h,s.minBottom,s.maxBottom);this.left=l,this.top=c,this.right=d,this.bottom=u,this.$emit("dragging",this.left,this.top),this.dragging=!0},moveHorizontally(t){const[e]=y(this.grid,t,this.top,1),i=b(e,this.bounds.minLeft,this.bounds.maxLeft);this.left=i,this.right=this.parentWidth-this.width-i},moveVertically(t){const[,e]=y(this.grid,this.left,t,1),i=b(e,this.bounds.minTop,this.bounds.maxTop);this.top=i,this.bottom=this.parentHeight-this.height-i},handleResize(t){let e=this.left,i=this.top,s=this.right,a=this.bottom;const n=this.mouseClickPosition,r=this.aspectFactor,o=n.mouseX-(t.touches?t.touches[0].pageX:t.pageX),h=n.mouseY-(t.touches?t.touches[0].pageY:t.pageY);!this.widthTouched&&o&&(this.widthTouched=!0),!this.heightTouched&&h&&(this.heightTouched=!0);const[l,c]=y(this.grid,o,h,this.scale);this.handle.includes("b")?(a=b(n.bottom+c,this.bounds.minBottom,this.bounds.maxBottom),this.lockAspectRatio&&this.resizingOnY&&(s=this.right-(this.bottom-a)*r)):this.handle.includes("t")&&(i=b(n.top-c,this.bounds.minTop,this.bounds.maxTop),this.lockAspectRatio&&this.resizingOnY&&(e=this.left-(this.top-i)*r)),this.handle.includes("r")?(s=b(n.right+l,this.bounds.minRight,this.bounds.maxRight),this.lockAspectRatio&&this.resizingOnX&&(a=this.bottom-(this.right-s)/r)):this.handle.includes("l")&&(e=b(n.left-l,this.bounds.minLeft,this.bounds.maxLeft),this.lockAspectRatio&&this.resizingOnX&&(i=this.top-(this.left-e)/r));const d=f(this.parentWidth,e,s),u=v(this.parentHeight,i,a);!1!==this.onResize(this.handle,e,i,d,u)&&(this.left=e,this.top=i,this.right=s,this.bottom=a,this.width=d,this.height=u,this.$emit("resizing",this.left,this.top,this.width,this.height),this.resizing=!0)},changeWidth(t){const[e]=y(this.grid,t,0,1);let i=b(this.parentWidth-e-this.left,this.bounds.minRight,this.bounds.maxRight),s=this.bottom;this.lockAspectRatio&&(s=this.bottom-(this.right-i)/this.aspectFactor);const a=f(this.parentWidth,this.left,i),n=v(this.parentHeight,this.top,s);this.right=i,this.bottom=s,this.width=a,this.height=n},changeHeight(t){const[,e]=y(this.grid,0,t,1);let i=b(this.parentHeight-e-this.top,this.bounds.minBottom,this.bounds.maxBottom),s=this.right;this.lockAspectRatio&&(s=this.right-(this.bottom-i)*this.aspectFactor);const a=f(this.parentWidth,this.left,s),n=v(this.parentHeight,this.top,i);this.right=s,this.bottom=i,this.width=a,this.height=n},handleUp(){this.handle=null,this.resetBoundsAndMouseState(),this.dragEnable=!1,this.resizeEnable=!1,this.resizing&&(this.resizing=!1,this.$emit("resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,this.$emit("dragstop",this.left,this.top)),T(document.documentElement,L.move,this.handleResize)}},computed:{style(){return{transform:`translate(${this.left}px, ${this.top}px)`,width:this.computedWidth,height:this.computedHeight,zIndex:this.zIndex,...this.dragging&&this.disableUserSelect?k:R}},actualHandles(){return this.resizable?this.handles:[]},computedWidth(){return"auto"!==this.w||this.widthTouched?this.width+"px":"auto"},computedHeight(){return"auto"!==this.h||this.heightTouched?this.height+"px":"auto"},resizingOnX(){return Boolean(this.handle)&&(this.handle.includes("l")||this.handle.includes("r"))},resizingOnY(){return Boolean(this.handle)&&(this.handle.includes("t")||this.handle.includes("b"))},isCornerHandle(){return Boolean(this.handle)&&["tl","tr","br","bl"].includes(this.handle)}},watch:{active(t){this.enabled=t,t?this.$emit("activated"):this.$emit("deactivated")},z(t){(t>=0||"auto"===t)&&(this.zIndex=t)},x(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveHorizontally(t))},y(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveVertically(t))},lockAspectRatio(t){this.aspectFactor=t?this.width/this.height:void 0},minWidth(t){t>0&&t<=this.width&&(this.minW=t)},minHeight(t){t>0&&t<=this.height&&(this.minH=t)},maxWidth(t){this.maxW=t},maxHeight(t){this.maxH=t},w(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeWidth(t))},h(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeHeight(t))}}},E=i(89);const _=(0,E.Z)(z,[["render",g]]);var B=_,C=i(2621),M=i(62),W=i(6169),D={setup(){return{appStore:(0,C.q)(),bannersStore:(0,M.i)(),toaster:(0,W.P)()}},data:()=>({isTextEditMode:!1}),props:{rounded:{type:Boolean},id:{type:String},zoom:{type:Number},editable:{type:Boolean,default:!1},banner:{type:Object,required:!0},canvas:{type:Object,required:!0},scheme:{type:String}},methods:{async init(){document.addEventListener("keydown",this._keyListener)},enterTextEditMode(t){if(this.isTextEditMode||!this.editable)return;this.isTextEditMode=!0;const e=t.target.closest(".canvas_text").querySelector("textarea");this.$nextTick((()=>{e.select()}))},_keyListener(t){const{key:e,shiftKey:i,target:{tagName:s}}=t,a="INPUT"===s||"TEXTAREA"===s;switch(e){case"Escape":this.activeLayer&&!a&&this.bannersStore.deactivateLayer(this.activeLayer);break;case"Backspace":case"Delete":this.activeLayer&&!a&&this.bannersStore.deleteLayer(this.activeLayer);break;case"ArrowUp":case"ArrowRight":case"ArrowDown":case"ArrowLeft":this.activeLayer&&!a&&(t.preventDefault(),this.bannersStore.shiftLayer(this.activeLayer,e.slice(5).toLowerCase(),i));break;default:break}}},computed:{layers(){return this.banner.layers.map((t=>t)).reverse()},activeLayer(){return this.bannersStore.activeLayer}},mounted(){this.init()},beforeUnmount(){document.removeEventListener("keydown",this._keyListener)},components:{BannerCopyright:u.Z,VueDraggableResizable:B}};const F=(0,E.Z)(D,[["render",d],["__scopeId","data-v-5cbe1eda"]]);var H=F},205:function(t,e,i){"use strict";i.d(e,{Z:function(){return d}});var s=i(3396),a=i(7139);const n=t=>((0,s.dD)("data-v-5251ae98"),t=t(),(0,s.Cn)(),t),r=n((()=>(0,s._)("div",{class:"banner_copyright_info"},[(0,s._)("div",{class:"banner_copyright_info_title"},"Сервис готовых баннеров"),(0,s._)("div",{class:"banner_copyright_info_link"},"www.ai-banner.com")],-1)));function o(t,e,i,n,o,h){const l=(0,s.up)("AppIcon");return(0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["banner_copyright",[`banner_copyright--${i.variant}`]])},[(0,s.Wm)(l,{icon:"logo",size:16,class:"banner_copyright_logo"}),r],2)}var h={props:{variant:{type:String,default:"light"}}},l=i(89);const c=(0,l.Z)(h,[["render",o],["__scopeId","data-v-5251ae98"]]);var d=c}}]);
//# sourceMappingURL=334.802d37ba.js.map